package exploits

import (
	"fmt"
)

// Define an interface for every Exploit modules
type Exploit interface {
	Run(target string) error
	Name() string // Name of the exploit
}

// Generate registered exploits
type ExploitManager struct {
	exploits map[string]Exploit
}

// Create a new Explolit manager
func NewExploitManager() *ExploitManager {
	return &ExploitManager{
		exploits: make(map[string]Exploit),
	}
}

// Register the exploit
func (m *ExploitManager) Register(exploit Exploit) {
	m.exploits[exploit.Name()] = exploit
}

// Execute exploit by calling it's name
func (m *ExploitManager) RunExploit(name, target string) error {
	exploit, exists := m.exploits[name]
	if !exists {
		return fmt.Errorf("exploit %s not found", name)
	}
	return exploit.Run(target)
}
